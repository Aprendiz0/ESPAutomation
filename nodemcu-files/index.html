<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>NodeMCU</title>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
            margin: 0;
        }

        input {
            width: -webkit-fill-available;
            height: 40px;
            background-color: lightgrey;
            color: #070707;
            border: 0;
            margin: 5px;
            text-align: center;
        }

        input[type=button] {
            cursor: pointer;
            width: -webkit-fill-available;
            height: 40px;
            background-color: rgb(0, 180, 150);
            color: #fafafa;
            margin: 5px;
        }

        ul.nav {
            list-style-type: none;
            margin: 0;
            padding: 0;
            width: 200px;
            background-color: #f1f1f1;
            position: fixed;
            height: 100%;
            overflow: auto;
        }

        ul.nav>li>a {
            display: block;
            color: #000;
            padding: 8px 16px;
            text-decoration: none;
            cursor: pointer;
        }

        li>a.active {
            background-color: #4CAF50;
            color: white;
        }

        li>a:hover:not(.active) {
            background-color: #555;
            color: white;
        }

        div.nav-container {
            margin-left: 200px;
            padding: 1px 16px;
        }

        .loading {
            width: 40px;
            height: 40px;
            margin: 100px auto;
            background-color: #333;

            border-radius: 100%;
            -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;
            animation: sk-scaleout 1.0s infinite ease-in-out;
        }

        .center {
            display: flex;
            justify-content: center;
        }

        @-webkit-keyframes sk-scaleout {
            0% {
                -webkit-transform: scale(0)
            }

            100% {
                -webkit-transform: scale(1.0);
                opacity: 0;
            }
        }

        @keyframes sk-scaleout {
            0% {
                -webkit-transform: scale(0);
                transform: scale(0);
            }

            100% {
                -webkit-transform: scale(1.0);
                transform: scale(1.0);
                opacity: 0;
            }
        }

        #pageTitle {
            color: #070707;
            border-bottom: 5px solid rgb(0, 180, 150);
        }
    </style>
</head>

<body>

    <ul class="nav">
        <li>
            <a data-load="home.html" data-title="ESPAutomation" onclick="load(this); return false">
                Home
            </a>
        </li>
        <li>
            <a data-load="wifi_config.html" data-title="Wifi Config" onclick="load(this); return false">
                Wifi Config
            </a>
        </li>
    </ul>

    <div class="nav-container">
        <div id="pageLoad" class="loading" style="display: none;"></div>
        <h1 id="pageTitle" style="display: none;">Wifi config</h1>
        <div id="page" class="center"></div>
    </div>

</body>

<script>
    function load(e) {
        let elems = document.querySelectorAll("ul.nav>li>a")
        for (let i = 0; i < elems.length; i++) {
            elems[i].classList.remove("active")
        }
        e.classList.add("active")

        let pageLoad = document.getElementById("pageLoad")
        let pageTitle = document.getElementById("pageTitle")
        let page = document.getElementById("page")

        page.innerHTML = ""
        pageLoad.style.display = ""
        pageTitle.style.display = "none"

        fetch(e.dataset.load)
            .then(function (x) {
                return x.text()
            })
            .then(function (r) {
                page.innerHTML = r
                let script = document.querySelector("#page>script")
                if (script) eval(script.text)
            }).catch(function () {
                setTimeout(function () {
                    alert('Error on request')
                }, 100)
            }).finally(function () {
                pageLoad.style.display = "none"
                pageTitle.innerHTML = e.dataset.title
                pageTitle.style.display = ""
            })

    }

    (function () {
        load(document.querySelector("ul.nav>li>a"))
    })()
</script>

</html>